@page "/Appointment/Add"

@layout TeacherLayout

@using HK_Clinic2.Models
@using HK_Clinic2.Services

@inject AppointmentService Service
@inject PatientService PService
@inject NavigationManager NavigationManager


<h3>Add an Appointment</h3>
<div class="container">
    <EditForm Model="appointment" OnValidSubmit="CreateAppointment">
        <DataAnnotationsValidator />
        <ValidationSummary />
        <div class="col-4">
            <label for="patientId">Patient ID:*</label>
            <InputSelect @bind-Value="appointment.AppointmentId" id="patientId" class="form-control">
                <option value="">Select a  Patient ID...</option>
                @foreach (var item in patients)
                {
                    <option value=@item.PatientId>@item.StudentId @item.EmployeeId</option>
                }
            </InputSelect>
        </div>

        <div class="form-group col-4">
            <label for="AppointmentDateTime">Appointment Date and Time: </label>
            <input type="datetime-local" name="AppointmentDateTime" class="form-control" @bind-value="appointment.AppointmentDateTime">
            <ValidationMessage For="@(() => appointment.AppointmentDateTime)" />
        </div>

        <div class="form-group col-4">
            <label for="reason">Reason: </label>
            <InputTextArea class="form-control" id="reason" rows="3" @bind-Value="appointment.Reason" placeholder="Enter the reason of the appointment..."></InputTextArea>
            <ValidationMessage For="@(() => appointment.Reason)" />
        </div>

        <div class="form-group col-4">
            <label for="note">Note: </label>
            <InputTextArea class="form-control" id="note" rows="3" @bind-Value="appointment.Note" placeholder="Enter a note..."></InputTextArea>
            <ValidationMessage For="@(() => appointment.Note)" />
        </div>

        @*<div>
            <label>Appointment Status: </label>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="status" value="option1">
                <label class="form-check-label" for="status">
                    Confirmed
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="status2" value="option2" checked>
                <label class="form-check-label" for="status2">
                    Pending
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="status2" value="option2">
                <label class="form-check-label" for="status2">
                    Canceled
                </label>
            </div>
            <ValidationMessage For="@(() => appointment.Status)" />
        </div>*@
        <div class="mt-4"></div>
        <button type="submit" class="btn btn-outline-primary">Add Appointment</button>
        &nbsp;&nbsp;
        <a href="Appointment/List" class="btn btn-outline-secondary" role="button">Go back to the list</a>
    </EditForm>
</div>

@code {
    Appointment appointment = new Appointment();

    List<Patient> patients = new List<Patient>();

    protected override void OnInitialized()
    {
        patients = PService.GetPatients();
    }

    private void CreateAppointment()
    {
        Service.AddAppointment(appointment);
        appointment = new Appointment();

        // May navigate to the Appointment/List component
        NavigationManager.NavigateTo("Appointment/List");
    }

}